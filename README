NAME
    vmm - Manage VMware virtual machines

SYNOPSIS
            vmm <command> [options]

    Global syntax:
                vmm <command> [-f] [-v+] [-w seconds] [@profile]

    Command specific syntax:
                vmm df [-h] [datastore...]
                vmm list [-d col1,col2...] [vms|datastores|hosts|pool] [patterns...]
                vmm migrate [-p low|normal|high] [-o pool] <vms...> <host>
                vmm move [-o pool] <vms...> <datastore>
                vmm setpool <low|normal|high> <cpu|mem|all> <pools...>
                vmm show [vm|datastore|host|pool] [vms...]
                vmm snapshot [--t title] <vms...>
                vmm state <on|off|suspend|reboot|shutdown|restart|standby> <vms...>
                vmm version

    Not yet implemented:
                vmm clone [-c count] [-m max] [-a datastore...] <source vm> <target vm>
                vmm logs <vms...>
                vmm host [maintenance|restore|restart|shutdown] <hosts...>

COMMANDS
    clone   Clone a given VM to another VM name. If -c is specified multiple
            copies are made. Each VM name will be incremented in the usual
            Perlish way. e.g.: DB1, DB2, DB3 etc. Specify -m to specify at
            what point vmm should give up trying.

            If -a is unspcified the datastore of the source VM is copied as
            the new clones datastore. If -a is specified the data store will
            be set during cloning. If -a contains a comma denoted list the
            datastores will be alternated during cloning. e.g. -a 1,2 copies
            to datastore 1 then 2 then starts again at 1.

    df      Display disk usage information about datastores. If a list of
            matches is provided, the data store list is filtered for those
            items.

    list    Display a list of the given items matching a pattern.

            Possible lists include (selection can be plural or singular): *
            vms (default if unspecified) * datastores * hosts * pools

    migrate Migrate a given list of VMs to another host.

    move    Move a given list of VMs to another datastore.

    setpool Set the share level on the given resource pools.

    show    Show information about a given object. If no specific object
            type is specified 'vm' is assumed. If no specific matching
            pattern is specified all objects of that type are listed.

    snapshot
            Take a snapshot of the matching VM's. If '-t' is specified, it
            is used as the title of the snapshot. Otherwise the current time
            is used.

    state   Set the state of a list of VMs.

            This can be any of the following choices: * on - Power up the
            specified VMs * off - Power down the specified VMs. This is a
            hard power state so data loss could occur. * suspend - Power the
            machine into standby mode. This is a hard power state which does
            not rely on VMware tools. * restart - Hard power cycle the VMs.
            Like 'off' this is a forced power state so data loss could
            occur. * shutdown - Try shutting down the machine via VMware
            tools. * standby - Try to put the machine into the soft standby
            state. * reboot - Try shutting down the machine via VMware
            tools.

    version Display various version informaiton about the connected vServer
            and local API. This command is the default if no actual command
            is specified (i.e. just running 'vmm' with nothing else
            specified).

OPTIONS
    [@profile]

            Used during: All operations
            Default: First specified profile in config
            Type: Profile name

            Specifies which profile to use when addressing the vServer. e.g.
            vmm version @cluster1 OR vmm version @cluster2

            Switches between the two profiles setup in the VMM config file

    -c

            Used during: migrate
            Default: 1
            Type: Number

            Specifies how many VMs should be created during a clone
            operation. If more than one the target VM name is incremented a
            maximum number of times specified by the -m flag. The name of
            the target VM is incremented in the usual Perlish way. e.g.

            DBS1, DBS2, DBS3... DBS10 DB00, DB01, DB02... DB99 DBAA, DBAB,
            DBAC,,, DBZZ

    --display [col1,col2...]
    -d [col1,col2...]

            Used during: list
            Default: Name
            Type:
                Command seperated list of columns to display in tabular
                output when using the 'list' command. See also: -s to
                specify the seperation character to use between the columns.

            Specify a data store for operations that require it.

    --datastore [datastore]
    --ds [datastore]
    -a [datastore]

            Used during: migrate
            Default: Same as source VM
            Type: Datastore name

            Specify a data store for operations that require it.

    -f

            Used during: All operations
            Default: off
            Type: Switch

            Force continue if an error occurs. Normaly if an error occurs
            vmm will stop processing any further VMs specified on the
            command line. If this flag is enabled vmm will instead continue
            operation as if no error occured.

    --human
    -h

            Used during: df
            Default: off
            Type: Switch

            Display the numbers of the 'df' command in a human readable
            format.

    -m

            Used during: clone
            Default: 99
            Type: Number

            Specify the maximum number of incremental names to try before
            giving up. When using the -c flag during a migrate operation vmm
            trys to find a free target VM name by incrementing the default
            name given by the user (see -c). This flag specifies how many
            attempts vmm should make before giving up attempting to find a
            free slot.

    --dryrun
    -n

            Used during: All operations
            Default: off
            Type: Switch

            Dry run mode. When enabled vmm will continue as normal but no
            actual call to the VMware VServer is made.

    --pool [pool]
    -o [pool]

            Used during: clone, migrate, move
            Default: Same as the source VM
            Type: Pool name

            Specifies the alternate pool name to use when migrating or
            cloning machines. If unspecified the source VM's pool is used
            instead.

    --priority [priority]
    -p [priority]

            Used during: migrate
            Default: low
            Type: Choice of: low, normal, high

            Specifies the priority when migrating VMs.

    --seperator [character]
    -s [character]

            Used during: list
            Default: \t (tab)
            Type: String

            Specifies the string to display between columns when outputing a
            list.

    --title [title]
    -t [title]

            Used during: snapshot
            Default: The Unix EPOC
            Type: String

            The title of the snapshot to create.

    -v
    --verbose

            Used during: All operations
            Default: 0
            Type: Accumulating switch

            Be more verbose when outputting information to STDERR. Specify
            multiple times to increase verbosity.

    -w [seconds]
    -wait [seconds]

            Used during: clone, migrate, setpool, state
            Default: 0
            Type: Number of seconds

            Force a wait for the specified number of seconds between VM
            operations.

DESCRIPTION
    A command line tool for the manipulation of VMware Virtual Machines
    (VM).

EXAMPLES
    vmm migrate DBS* Carl
        Migrate all virtual machines matching 'DBS*' to the 'Carl' host.

    vmm migrate DBS* Lenny -w 60 -o Active -p high
        Migrate all virtual machines matching 'DBS*' with high priority to
        the 'Active' pool on the 'Lenny' host waiting 60 seconds between
        machine.

    vmm clone VM01 VM02
        Clone VM01 to VM02. Since neither the datasource (-d) or pool (-o)
        is specified these details are copied from VM01.

    vmm clone DB00 DB01 -c 30
        Clone DB01 to DB02 creating 30 copies. This will actually make the
        machines DB01 to DB30. Since neither the datasource (-d) or pool
        (-o) is specified these details are copied from VM01.

    vmm clone DB00 DB01 -c 30 -d SAN1,SAN2 -o Active
        Same as the above example but spread the datastores across SAN1 and
        SAN2 and move the machine to the 'Active' pool.

    vmm move DB00 DB01 SAN2 @cluster2
        Move VMs DB00 and DB01 to the SAN2 datastore within profile
        'cluster2'.

    vmm state on DB00 DB01 -w 30
        Turn DB00 and DB01 on waiting 30 seconds between machines.

FILES
    /etc/vmmrc
            VMM config file for all users.

    .vmmrc  VMM config file for the local user.

CONFIG
    The /etc/vmmrc and .vmmrc files will be processed to determine VMM's
    configuration, the latter file taking precedence.

    The layout of the config file spcifies which profiles to use.

            [GLOBAL]
            rewrite host = s/^(.+?)\./\1/
            verbose = 2
            profile = Cluster1
            dryrun = 0
            human = 1
            seperator = \t
        
            [Cluster1]
            url = https://cluster1.acme.edu
            username = admin
            password = password
        
            [Cluster2]
            url = https://cluster2.acme.edu.au
            username = administrator
            password = changeme

    [GLOBAL]
            The meta global section. Any option specified here will be
            automatically carried into each profiles config.

            In the main example Cluster1 will have a 'verbose' option of 2.
            Cluster2 will have a 'verbose' option of 1 since it overrides
            the global setting.

    [profile]
            The name (case-insensitive) of the profile to define.

    url     The connection URL of the vServer system within the profile

    username and password
            The authentication information when connecting to the vServer.

    dryrun  Specify a default dry run value. See -n for further information.

    human   Always output numbers in a human readable format rather than the
            raw form.

    priority
            Specify a default priority when using any command that is '-p'
            compatible.

    profile Specify the default profile to use if none is explicitally set.
            If not specified the first found profile in the config file is
            used.

    rewrite host
            Specify a substitution regular expression to use when correcting
            host names. The value given in the above example will remove any
            trailing DNS name correcting 'host1.a.very.long.dns.com' to
            'host1'.

    seperator
            Specify the seperator character used when outputting tabular
            data with the 'list' command.

    verbose Specify a default verbosity level. See -v for further
            information.

BUGS
    Quite probably.

    Please report to https://github.com/hash-bang/VMM when found.

AUTHOR
    Matt Carter <m@ttcarter.com>

